extends layout

block content
  .main-container
    h1= title
    ul
    h2= 'Users'
    if users && users.length > 0
      each user in users ? users : []
        li= user.name
        li= user.email
        br
    else
      li= 'No users have been created'
    ul
    h2= 'Submissions'
    if submissions && submissions.length > 0
      each submission in submissions
        li= submission
        br
    else
      li= 'No submissions have been created'
    br
    h2= 'Episode Upload'
    .fileUpload
      lable(for="episodeNum")= "Episode Number:"
      input(type='text', placeholder="324")
      br
      input(type="file")
      br
      input(type='submit', value='Continue' onclick='upload()')
  
  script.
    function upload() {
      const numField = document.querySelector("div.fileUpload input[type='text']");
      const fileField = document.querySelector("div.fileUpload input[type='file']");
      if (!numField.value || !fileField.files[0]){
        console.log("Fields incomplete");
        return;
      }
      var data = new FormData()
      data.append('episodeAudio', fileField.files[0])
      data.append('episodeNum', numField.value)
      console.log(fileField.files[0]);
      console.log(numField.value);
      fetch('/admin', {
        method: 'POST',
        body: data,
        enctype: "multipart/form-data"
      }).then(res => res.json()).then(data => console.log(data));
    };